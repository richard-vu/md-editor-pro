{
  "version": 3,
  "sources": ["toolbar.ts"],
  "sourcesContent": ["interface EditorSelection {\r\n    start: number;\r\n    end: number;\r\n    text: string;\r\n}\r\n\r\ninterface EditorAPI {\r\n    getSelection(): EditorSelection;\r\n    insertText(text: string, offsetStart?: number, offsetEnd?: number): void;\r\n    replaceSelection(newText: string): void;\r\n    insertTemplate(prefix: string, suffix: string, defaultContent: string): void;\r\n    insertAtCursor(text: string): void;\r\n    getValue(): string;\r\n    focus(): void;\r\n}\r\n\r\ninterface ToolbarActions {\r\n    [key: string]: () => void;\r\n}\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    // Get VS Code API from window (shared with editor.ts)\r\n    const vscode = (window as any).vscodeApi;\r\n\r\n    if (!vscode) {\r\n        console.error('VS Code API not found. Make sure editor.ts loads first.');\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * Wait for editorAPI to be available\r\n     */\r\n    function waitForEditorAPI(callback: () => void, maxAttempts: number = 50): void {\r\n        let attempts = 0;\r\n        const interval = setInterval(() => {\r\n            attempts++;\r\n            if ((window as any).editorAPI) {\r\n                clearInterval(interval);\r\n                console.log('Editor API ready, initializing toolbar');\r\n                callback();\r\n            } else if (attempts >= maxAttempts) {\r\n                clearInterval(interval);\r\n                console.error('Editor API not available after waiting');\r\n            }\r\n        }, 100);\r\n    }\r\n\r\n    /**\r\n     * Toolbar actions - properly format selected text or insert template\r\n     */\r\n    const toolbarActions: ToolbarActions = {\r\n        bold: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Wrap selected text with **\r\n                editorAPI.replaceSelection(`**${selection.text}**`);\r\n            } else {\r\n                // Insert template with placeholder\r\n                editorAPI.insertTemplate('**', '**', 'bold text');\r\n            }\r\n        },\r\n\r\n        italic: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Wrap selected text with *\r\n                editorAPI.replaceSelection(`*${selection.text}*`);\r\n            } else {\r\n                // Insert template with placeholder\r\n                editorAPI.insertTemplate('*', '*', 'italic text');\r\n            }\r\n        },\r\n\r\n        heading: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Add ## prefix to selected text\r\n                editorAPI.replaceSelection(`## ${selection.text}`);\r\n            } else {\r\n                // Insert heading template\r\n                editorAPI.insertTemplate('## ', '', 'Heading');\r\n            }\r\n        },\r\n\r\n        link: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Wrap selected text in link, with URL selected\r\n                editorAPI.insertTemplate(`[${selection.text}](`, ')', 'url');\r\n            } else {\r\n                // Insert link template with text selected\r\n                editorAPI.insertTemplate('[', '](url)', 'link text');\r\n            }\r\n        },\r\n\r\n        image: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Wrap selected text as alt text, with URL selected\r\n                editorAPI.insertTemplate(`![${selection.text}](`, ')', 'image-url');\r\n            } else {\r\n                // Insert image template with alt text selected\r\n                editorAPI.insertTemplate('![', '](image-url)', 'alt text');\r\n            }\r\n        },\r\n\r\n        code: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Wrap selected text in code block\r\n                editorAPI.replaceSelection(`\\`\\`\\`\\n${selection.text}\\n\\`\\`\\``);\r\n            } else {\r\n                // Insert empty code block with placeholder\r\n                editorAPI.insertTemplate('```\\n', '\\n```', 'code');\r\n            }\r\n        },\r\n\r\n        table: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const tableTemplate = `| Header 1 | Header 2 | Header 3 |\r\n| -------- | -------- | -------- |\r\n| Cell 1   | Cell 2   | Cell 3   |\r\n| Cell 4   | Cell 5   | Cell 6   |\r\n`;\r\n            editorAPI.insertAtCursor(tableTemplate);\r\n        },\r\n\r\n        list: () => {\r\n            const editorAPI = (window as any).editorAPI as EditorAPI;\r\n            const selection = editorAPI.getSelection();\r\n            \r\n            if (selection.text) {\r\n                // Convert selected lines to bullet list\r\n                const lines = selection.text.split('\\n');\r\n                const formattedList = lines.map(line => line.trim() ? `- ${line}` : '').join('\\n');\r\n                editorAPI.replaceSelection(formattedList);\r\n            } else {\r\n                // Insert single list item\r\n                editorAPI.insertAtCursor('- ');\r\n            }\r\n        },\r\n\r\n        'export-pdf': () => {\r\n            vscode.postMessage({\r\n                type: 'command',\r\n                command: 'md-editor-pro.exportPdfFile',\r\n            });\r\n        },\r\n\r\n        translate: () => {\r\n            vscode.postMessage({\r\n                type: 'command',\r\n                command: 'md-editor-pro.translate',\r\n            });\r\n        },\r\n    };\r\n\r\n    /**\r\n     * Initialize toolbar\r\n     */\r\n    function initToolbar(): void {\r\n        console.log('Initializing toolbar...');\r\n        const buttons = document.querySelectorAll('[data-action]');\r\n        console.log(`Found ${buttons.length} toolbar buttons`);\r\n\r\n        // Add click handlers to all toolbar buttons\r\n        buttons.forEach(button => {\r\n            button.addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n                const action = button.getAttribute('data-action');\r\n                console.log(`Toolbar action clicked: ${action}`);\r\n\r\n                if (action && toolbarActions[action]) {\r\n                    try {\r\n                        toolbarActions[action]();\r\n                        const editorAPI = (window as any).editorAPI as EditorAPI;\r\n                        if (editorAPI && editorAPI.focus) {\r\n                            editorAPI.focus();\r\n                        }\r\n                    } catch (error) {\r\n                        console.error(`Error executing action ${action}:`, error);\r\n                    }\r\n                } else {\r\n                    console.warn(`Unknown action: ${action}`);\r\n                }\r\n            });\r\n        });\r\n\r\n        console.log('Toolbar initialized successfully');\r\n    }\r\n\r\n    // Expose toolbar actions for keyboard shortcuts\r\n    (window as any).toolbarActions = toolbarActions;\r\n\r\n    // Initialize when DOM is ready AND editorAPI is available\r\n    function startInitialization(): void {\r\n        waitForEditorAPI(initToolbar);\r\n    }\r\n\r\n    if (document.readyState === 'loading') {\r\n        document.addEventListener('DOMContentLoaded', startInitialization);\r\n    } else {\r\n        startInitialization();\r\n    }\r\n})();\r\n"],
  "mappings": "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",
  "names": []
}
